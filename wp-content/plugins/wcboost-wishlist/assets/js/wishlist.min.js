(function(n){var i=function(t){return t.is(".processing")||t.parents(".processing").length};var o=function(t){if(!n.fn.block||!t){return}if(!i(t)){t.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})}};var s=function(t){if(!n.fn.unblock||!t){return}t.removeClass("processing").unblock()};var t=function(){this.selectors={text:".wcboost-wishlist-button__text",icon:".wcboost-wishlist-button__icon"};this.addToWishlist=this.addToWishlist.bind(this);this.removeFromWishlist=this.removeFromWishlist.bind(this);this.updateButton=this.updateButton.bind(this);this.updateFragments=this.updateFragments.bind(this);n(document.body).on("click",".wcboost-wishlist-button--ajax",{addToWishlistHandler:this},this.onButtonClick);if("yes"===wcboost_wishlist_params.allow_adding_variations){n(".variations_form").on("found_variation",{addToWishlistHandler:this},this.onVariationFound).on("reset_data",{addToWishlistHandler:this},this.onVariationReset)}};t.prototype.onButtonClick=function(t){var i=t.data.addToWishlistHandler;var e=n(t.currentTarget);if(!e.hasClass("added")){t.preventDefault();i.addToWishlist(e)}else if("remove"===wcboost_wishlist_params.exists_item_behavior){t.preventDefault();i.removeFromWishlist(e)}};t.prototype.addToWishlist=function(e){var o=this;var t={product_id:e.data("product_id"),quantity:e.data("quantity")};if(!t.product_id){return}n.post({url:woocommerce_params.wc_ajax_url.toString().replace("%%endpoint%%","add_to_wishlist"),data:t,dataType:"json",beforeSend:function(){e.removeClass("added").addClass("loading");o.updateButton(e,"loading")},success:function(t){if(!t.success){return}var i=t.data.fragments;o.updateButton(e,"added",t.data);if(e.data("variations")){o.updateButton(e,"update_variations",{variation_id:t.data.product_id,added:"yes"})}o.updateFragments(i);n(document.body).trigger("added_to_wishlist",[e,i]);if("yes"===wcboost_wishlist_params.wishlist_redirect_after_add){window.location=wcboost_wishlist_params.wishlist_url}},complete:function(){e.removeClass("loading")}})};t.prototype.removeFromWishlist=function(e){var o=this;var t=new URLSearchParams(e[0].search);var i={item_key:t.get("remove-wishlist-item"),_wpnonce:t.get("_wpnonce")};if(!i.item_key){return}n.post({url:woocommerce_params.wc_ajax_url.toString().replace("%%endpoint%%","remove_wishlist_item"),data:i,dataType:"json",beforeSend:function(){e.removeClass("added").addClass("loading");o.updateButton(e,"loading")},success:function(t){if(!t.success){return}var i=t.data.fragments;o.updateButton(e,"removed",t.data);if(e.data("variations")){o.updateButton(e,"update_variations",{variation_id:t.data.product_id,added:"no"})}o.updateFragments(i);n(document.body).trigger("removed_from_wishlist",[e,i])},complete:function(){e.removeClass("loading")}})};t.prototype.onVariationFound=function(t,i){var e=t.data.addToWishlistHandler;var o=n(t.target).closest(".product").find(".wcboost-wishlist-button");var s=o.data("variations");e.updateButton(o,"update_id",{product_id:i.variation_id});if("yes"===wcboost_wishlist_params.allow_adding_variations&&s){var a=s.find(function(t){return t.variation_id===i.variation_id});if(a){e.updateButton(o,a.added==="yes"?"added":"removed",a)}}};t.prototype.onVariationReset=function(t){var i=t.data.addToWishlistHandler;var e=n(t.target).closest(".product").find(".wcboost-wishlist-button");var o=e.data("variations");var s=null;i.updateButton(e,"update_id",{product_id:null});if(o){var a=o.find(function(t){return t.is_parent});if(a){s=a.variation_id}if("yes"===wcboost_wishlist_params.allow_adding_variations&&a){i.updateButton(e,a.added==="yes"?"added":"removed",a)}}if(!s){var r=new URLSearchParams(e[0].search);s=r.get("add-to-wishlist")}i.updateButton(e,"update_id",{product_id:s})};t.prototype.updateButton=function(t,i,e){switch(i){case"loading":t.addClass("loading");t.find(this.selectors.icon).html(wcboost_wishlist_params.icon_loading);break;case"added":t.removeClass("loading").addClass("added");switch(wcboost_wishlist_params.exists_item_behavior){case"view_wishlist":t.attr("href",e.wishlist_url?e.wishlist_url:wcboost_wishlist_params.wishlist_url);t.find(this.selectors.text).text(wcboost_wishlist_params.i18n_view_wishlist);t.find(this.selectors.icon).html(wcboost_wishlist_params.icon_filled);break;case"remove":t.attr("href",e.remove_url);t.find(this.selectors.text).text(wcboost_wishlist_params.i18n_remove_from_wishlist);t.find(this.selectors.icon).html(wcboost_wishlist_params.icon_filled);break;case"hide":t.hide();break}break;case"removed":t.removeClass("added loading");t.attr("href",e.add_url);t.find(this.selectors.text).text(wcboost_wishlist_params.i18n_add_to_wishlist);t.find(this.selectors.icon).html(wcboost_wishlist_params.icon_normal);break;case"update_id":t.data("product_id",e.product_id).attr("data-product_id",e.product_id);break;case"update_variations":var o=t.data("variations");if(o&&e.variation_id){var s=o.findIndex(function(t){return t.variation_id===e.variation_id});o[s]=n.extend({},o[s],e);t.data("variations",o)}break}};t.prototype.updateFragments=function(t){if(!t){return}n.each(t,function(t,i){n(t).replaceWith(i)});n(document.body).trigger("wishlist_fragments_loaded")};var e=function(t){var i=this;i.$form=t;i.$wrapper=t.closest(".wcboost-wishlist");i.updateForm=i.updateForm.bind(i);i.showNotices=i.showNotices.bind(i);i.$wrapper.off(".wcboost-wishlist");i.$wrapper.on("click.wcboost-wishlist",".wcboost-wishlist-form .product-remove > a",{wishlist:i},i.onRemoveItem);i.$wrapper.on("click.wcboost-wishlist","a.restore-item",{wishlist:i},i.onRestoreItem);i.$wrapper.on("change.wcboost-wishlist input.wcboost-wishlist",":input",{wishlist:i},i.onInputChagne);i.$wrapper.on("submit.wcboost-wishlist","form",{wishlist:i},i.onSubmitForm);i.$form.find('button[name="update_wishlist"]').prop("disabled",true).attr("aria-disabled",true)};e.prototype.onRemoveItem=function(t){t.preventDefault();var i=t.data.wishlist;n.ajax({url:t.currentTarget.href,type:"GET",dataType:"html",beforeSend:function(){o(i.$form)},success:function(t){i.updateForm(t)},complete:function(){if(i.$form){s(i.$form)}var t=n('[role="alert"]');if(t.length){n("html, body").animate({scrollTop:t.offset().top-100},1e3)}}})};e.prototype.onRestoreItem=function(t){t.preventDefault();var i=t.data.wishlist,e=i.$form?i.$form:i.$wrapper;n.ajax({url:t.currentTarget.href,type:"GET",dataType:"html",beforeSend:function(){o(e)},success:function(t){i.updateForm(t)},complete:function(){s(e)}})};e.prototype.onInputChagne=function(t){var i=t.data.wishlist;i.$form.find('button[name="update_wishlist"]').prop("disabled",false).attr("aria-disabled",false)};e.prototype.onSubmitForm=function(t){t.preventDefault();var i=t.data.wishlist;n("<input />").attr("type","hidden").attr("name","update_wishlist").attr("value","Update Wishlist").appendTo(i.$form);n.ajax({type:i.$form.attr("method"),url:i.$form.attr("action"),data:i.$form.serialize(),dataType:"html",beforeSend:function(){o(i.$form)},success:function(t){i.updateForm(t)},complete:function(){if(i.$form){s(i.$form)}}})};e.prototype.updateForm=function(t){var i=this,e=n.parseHTML(t),o=n(".wcboost-wishlist-form",e),s=n(".woocommerce-error, .woocommerce-message, .woocommerce-info",e);n(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove();if(!o.length){var a=n(".wishlist-empty",e).closest(".woocommerce");i.$wrapper.html(a.html());i.$form=null;s=s.not(".wishlist-empty");n(document.body).trigger("wishlist_emptied",[i])}else{if(i.$form){i.$form.replaceWith(o)}else{i.$wrapper.find(".wishlist-empty, .return-to-shop").remove();i.$wrapper.prepend(o)}i.$form=o;i.$form.find('button[name="update_wishlist"]').prop("disabled",true).attr("aria-disabled",true)}if(s.length>0){i.showNotices(s)}n(document.body).trigger("wishlist_updated",[i])};e.prototype.showNotices=function(t,i){if(i){i.prepend(t)}else{this.$wrapper.prepend(t)}};var a=function(t){var i=this;i.$container=t;i.$notice=n('<div class="wcboost-wishlist-share-notice" aria-hidden="true" style="display: none" />');i.$notice.append('<div class="wcboost-wishlist-share-notice__text" />');i.$notice.append('<a class="wcboost-wishlist-share-notice__close">'+wcboost_wishlist_params.i18n_close_button_text+"</a>");i.$notice.appendTo(document.body);i.openSocialShareIframe=i.openSocialShareIframe.bind(i);i.showCopiedNotice=i.showCopiedNotice.bind(i);i.showWishlistURLNotice=i.showWishlistURLNotice.bind(i);i.$container.off(".wcboost-wishlist");i.$container.on("click.wcboost-wishlist",".wcboost-wishlist-share-link",{wishlistShareHandler:i},i.onClickShareLink);i.$notice.on("click.wcboost-wishlist",".wcboost-wishlist-share-notice__close",{wishlistShareHandler:i},i.closeNotice)};a.prototype.onClickShareLink=function(t){var i=t.data.wishlistShareHandler,e=t.currentTarget.href,o=t.currentTarget.dataset.social;if("email"===o){return}if("link"===o){try{navigator.clipboard.writeText(e).then(i.showCopiedNotice)}catch(t){i.showWishlistURLNotice(e)}t.preventDefault();return}var s=i.openSocialShareIframe(e);if(s){t.preventDefault()}};a.prototype.openSocialShareIframe=function(t){var i=500,e=450,o=window.screen.height/2-(e/2+50),s=window.screen.width/2-(i/2+10),a="status=no,resizable=yes,width="+i+",height="+e+",left="+s+",top="+o+",screenX="+s+",screenY="+o+",toolbar=no,menubar=no,scrollbars=no,location=no,directories=no";if(window.screen.width<=i){return false}var r=window.open(t,"sharer",a);r.focus();return true};a.prototype.showCopiedNotice=function(){var t=this;t.$notice.find(".wcboost-wishlist-share-notice__text").html("").text(wcboost_wishlist_params.i18n_link_copied_notice);t.$notice.fadeIn(200);setTimeout(function(){t.$notice.fadeOut(200)},2e3)};a.prototype.showWishlistURLNotice=function(t){var i=this,e=n('<input type="text" value="'+t+'" />');i.$notice.find(".wcboost-wishlist-share-notice__text").html("").append(e);i.$notice.fadeIn(200);e.focus()};a.prototype.closeNotice=function(t){t.preventDefault();var i=t.data.wishlistShareHandler;i.$notice.fadeOut(200)};n(function(){new t;new e(n(".wcboost-wishlist-form"));new a(n(".wcboost-wishlist-share"))})})(jQuery);